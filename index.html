<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Streamyuk Player</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>
/* ================= BASE ================= */
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:Arial,Helvetica,sans-serif;
}
.player{
  position:relative;
  max-width:720px;
  margin:40px auto;
  border-radius:16px;
  overflow:hidden;
}
video{
  width:100%;
  background:#000;
}

/* ================= ADS OVERLAY ================= */
#adOverlay{
  position:absolute;
  inset:0;
  display:none;
  justify-content:center;
  align-items:center;
  background:rgba(0,0,0,.85);
  z-index:5;
  cursor:pointer;
}
#adOverlay button{
  background:#ffd400;
  border:0;
  padding:12px 18px;
  border-radius:10px;
  font-weight:700;
}

/* ================= HD POPUP ================= */
#hdPopup{
  position:absolute;
  inset:0;
  display:none;
  justify-content:center;
  align-items:center;
  background:rgba(0,0,0,.55);
  z-index:6;
}
#hdPopup button{
  background:#1da1f2;
  color:#fff;
  border:0;
  padding:12px 18px;
  border-radius:12px;
  font-weight:600;
}

/* ================= TITLE ================= */
h2{
  max-width:720px;
  margin:10px auto;
  padding:0 10px;
}
</style>
</head>
<body>

<h2 id="videoTitle">Loading...</h2>

<div class="player">
  <video id="player" controls playsinline></video>

  <!-- ADS OVERLAY (JANGAN DIHAPUS) -->
  <div id="adOverlay">
    <button>Klik untuk Lanjut</button>
  </div>

  <!-- HD POPUP -->
  <div id="hdPopup">
    <button>Switch to HD</button>
  </div>
</div>

<script>
/* ================= KONFIG ================= */
const API_URL = "videos.json"; // ganti kalau pakai API
const DEFAULT_VIDEO = "hecMwS8V1"; // fallback kalau fetch gagal

const AD_INTERVAL = 15000; // 15 detik
const HD_INTERVAL = 30000; // 30 detik

/* ================= ELEMENT ================= */
const player = document.getElementById("player");
const adOverlay = document.getElementById("adOverlay");
const hdPopup = document.getElementById("hdPopup");
const hdBtn = hdPopup.querySelector("button");
const titleEl = document.getElementById("videoTitle");

/* ================= TIMER ================= */
let adTimer = null;
let hdTimer = null;

/* ================= VIDEO ================= */
function playVideo(id, title=""){
  if(!id) return;

  titleEl.textContent = title || "Streaming Video";
  player.src = `https://cdn.videy.co/${id}.mp4`;

  player.onloadeddata = ()=>{
    player.play().catch(()=>{});
    showAd();
    startHDPopup();
  };
}

/* ================= ADS ================= */
function showAd(){
  adOverlay.style.display="flex";
  clearTimeout(adTimer);
  adTimer = setTimeout(()=>adOverlay.style.display="none",5000);
}

adOverlay.onclick = ()=>{
  adOverlay.style.display="none";
  clearTimeout(adTimer);
};

/* ================= HD POPUP ================= */
function startHDPopup(){
  clearInterval(hdTimer);
  hdTimer = setInterval(()=>{
    if(adOverlay.style.display==="flex") return;
    hdPopup.style.display="flex";
    setTimeout(()=>hdPopup.style.display="none",6000);
  }, HD_INTERVAL);
}

hdBtn.onclick = ()=>{
  hdPopup.style.display="none";
  player.load(); // reload ringan
};

/* ================= LOAD DATA ================= */
function loadVideos(){
  // kalau dibuka via file:// fetch akan error â†’ fallback
  if(location.protocol==="file:"){
    playVideo(DEFAULT_VIDEO,"Sample Video");
    return;
  }

  fetch(API_URL)
    .then(r=>r.json())
    .then(list=>{
      if(!list.length) throw "empty";
      playVideo(list[0].embed, list[0].title);
    })
    .catch(()=>{
      playVideo(DEFAULT_VIDEO,"Sample Video");
    });
}

loadVideos();
</script>

</body>
</html>
